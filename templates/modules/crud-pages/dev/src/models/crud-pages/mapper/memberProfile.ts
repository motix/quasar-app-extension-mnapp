import type { MappingProfile } from '@automapper/core';
import type { Member, MemberAm, MemberVm } from 'models/crud-pages/index.js';
import type { FieldConfig, MapperMetadata } from 'utils/automapper.js';

import { PojosMetadataMap } from '@automapper/pojos';

import { configureAndCreateMaps } from 'utils/automapper.js';

const memberBase: MapperMetadata<Member> = {
  uid: String,
  isActive: Boolean,
  email: String,
  fullName: String,
  photoUrl: String,
  slackId: String,
  inviteToFinanceChannels: Boolean,
};

PojosMetadataMap.create<Member>('Member', {
  ...memberBase,

  id: String,
});

PojosMetadataMap.create<MemberVm>('MemberVm', {
  ...memberBase,

  id: String,
});

PojosMetadataMap.create<MemberAm>('MemberAm', memberBase);

const fieldTypes: Partial<Record<keyof Member & keyof MemberVm & keyof MemberAm, FieldConfig>> = {
  slackId: { dataType: 'string', fieldType: 'optional' },
};

const memberProfile: MappingProfile = (mapper) => {
  configureAndCreateMaps<Member, MemberVm, MemberAm>(
    mapper,
    'Member',
    'MemberVm',
    'MemberAm',
    fieldTypes,
  );
};

export default memberProfile;
